---
pagetitle: コマンド入力方法
category: 1
---

## 概要

このページでは、コマンドの入力方法について紹介します。

## 基本的な入力の流れ

<div class="block block-large">コマンド番号選択</div>
<div class="arrow-bottom"></div>
<div class="block block-large">コマンド選択</div>

### コマンド番号選択

コマンド番号は、コマンドリストの任意の行をクリックすることで選択することができます。

#### 原作との違い

コマンド番号を複数選択するとき、原作では `Ctrl` キーの押下が必要でしたが、KMYでは必要ありません。

また、連続したコマンド番号を一斉選択するとき、原作では `Shift` キーの押下が必要でしたが、KMYでは以下の２つの方法が用意されています。

* `Shift` キーを使用する
* 「複数選択」ボタンを使用する
  + 最初の番号を選択
  + 「複数選択」ボタンを押して黒くする
  + 最後の番号を選択（ここで複数選択される）
  + 「複数選択」ボタンをもう一度押して白くする

#### コマンド選択ツール

現状、以下のツールが用意されています。

| 名前 | 説明 |
| -- | -- |
| 消去 | すべての選択を解除します |
| 全て | すべての行を選択します |
| 偶数 | 偶数番号を選択します |
| 奇数 | 奇数番号を選択します |
| ax+b | aの倍数にbを足した番号を選択します |

#### コマンド選択と時間経過

時間が経過して、コマンド選択中にコマンドが実行された場合、選択は1つずつ上へずれます。  
例えばコマンド選択ツールで偶数を選択した場合、そのあとにコマンドが実行されると奇数を選択ていることになりますので注意してください。

一番上のコマンドのみを選択していると、コマンドの選択が解除されたのと同じになります。特に登用コマンドなど、コマンド選択から入力完了まで時間のかかるものは注意してください。

なお、コマンドを入力するとき、内部ではコマンド番号ではなくコマンドが実行される年月で識別します。そのため、コマンド入力の瞬間にコマンドが実行されたとしても、入力がずれることはありません。

#### 範囲選択

任意のコマンド番号を選択してから「範囲」ボタンをクリックすると、選択したコマンド番号しか選択できない状態になります。  
この状態で、偶数・奇数など選択ツールと併用することで、特定の範囲内で複雑な入力を行うことが可能です。  
また、後述の挿入・削除とも併用することができます。

なお、範囲は飛び地にすることもできます。

### コマンド選択

実行するコマンドの選択については、[コマンド一覧](bas-commands.html)などを参考にしてください。

## 挿入・削除

すでに入力したコマンドを、任意の数だけ上にずらしたり、下にずらしたりすることができます。

### 挿入

選択した行の上に、空行を挿入します。2行以上続けて選択した場合は、空行が2行挿入されます。

飛び地となる行を選択することもできます。その場合でも、空行はあくまで選択された行の上に挿入されます。

最後の行（範囲選択仲の場合は範囲の最後の行）にあるコマンドは削除されます。

### 削除

選択した行を削除し、後続のコマンドを上に繰り上げます。複数の連続した行や、飛び地となる行を選択することもできます。

最後の行（範囲選択中の場合は範囲の最後の行）に、空行が挿入されます。

### 繰返

ループ入力。選択した行より後の行を、選択した行で繰り返し入力します。飛び地となる行を選択した場合、飛び地ごとにループ入力されるコマンドが変わります。

最後の行（範囲選択中の場合は範囲の最後の行）まですべての行に入力されます。

### 使用時の注意点

挿入・削除・繰り返しは、すでに入力したコマンドを書き換えます。  
そのため、内部では「すべてのコマンドを最初から入力しなおす」という動きになり、以下の制約がつきます。特に米売買などについては、特に警告も表示されずすぐ変更されますので、注意が必要です。  
なお、以下の注意事項は、対象となるコマンドが書き換えられる場合に有効です。例えば、徴兵コマンドが２番に入力されているときに３番の上に挿入する場合、２番の徴兵コマンドは以下の制約による影響を受けません。

* コマンド入力に特定の条件が必要なもの（例；都市技術が必要な高級兵種を徴兵するコマンド）が、挿入・削除・繰り返し実行時点で条件を満たしていない場合、挿入・削除・繰り返しの操作全体が失敗します。部分的に書き換えられることはありません
* 米売買など、コマンド入力時点の状態によって結果が変わるコマンドは、挿入・削除・繰り返しの時点で、新しい状態に基づく結果に書き換えられます

これらの制約を避けるためには、範囲選択を活用するといった工夫が必要になります。
